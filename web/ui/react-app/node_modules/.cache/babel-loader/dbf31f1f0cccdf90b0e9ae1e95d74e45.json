{"ast":null,"code":"import _classCallCheck from\"/usr/local/google/home/freinartz/repos/src/github.com/GoogleCloudPlatform/prometheus-clean/web/ui/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/usr/local/google/home/freinartz/repos/src/github.com/GoogleCloudPlatform/prometheus-clean/web/ui/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/usr/local/google/home/freinartz/repos/src/github.com/GoogleCloudPlatform/prometheus-clean/web/ui/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/usr/local/google/home/freinartz/repos/src/github.com/GoogleCloudPlatform/prometheus-clean/web/ui/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import $ from'jquery';import React,{Component}from'react';import{Button,InputGroup,InputGroupAddon,Input}from'reactstrap';import moment from'moment-timezone';import'tempusdominus-core';import'tempusdominus-bootstrap-4';import'../../../node_modules/tempusdominus-bootstrap-4/build/css/tempusdominus-bootstrap-4.min.css';import{dom,library}from'@fortawesome/fontawesome-svg-core';import{FontAwesomeIcon}from'@fortawesome/react-fontawesome';import{faChevronLeft,faChevronRight,faCalendarCheck,faArrowUp,faArrowDown,faTimes}from'@fortawesome/free-solid-svg-icons';library.add(faChevronLeft,faChevronRight,faCalendarCheck,faArrowUp,faArrowDown,faTimes);// Sadly needed to also replace <i> within the date picker, since it's not a React component.\ndom.watch();var TimeInput=/*#__PURE__*/function(_Component){_inherits(TimeInput,_Component);var _super=_createSuper(TimeInput);function TimeInput(){var _this;_classCallCheck(this,TimeInput);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.timeInputRef=React.createRef();_this.$time=null;_this.getBaseTime=function(){return _this.props.time||moment().valueOf();};_this.calcShiftRange=function(){return _this.props.range/2;};_this.increaseTime=function(){var time=_this.getBaseTime()+_this.calcShiftRange();_this.props.onChangeTime(time);};_this.decreaseTime=function(){var time=_this.getBaseTime()-_this.calcShiftRange();_this.props.onChangeTime(time);};_this.clearTime=function(){_this.props.onChangeTime(null);};_this.timezone=function(){return _this.props.useLocalTime?moment.tz.guess():'UTC';};return _this;}_createClass(TimeInput,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;this.$time=$(this.timeInputRef.current);this.$time.datetimepicker({icons:{today:'fas fa-calendar-check'},buttons:{//showClear: true,\nshowClose:true,showToday:true},sideBySide:true,format:'YYYY-MM-DD HH:mm:ss',locale:'en',timeZone:this.timezone(),defaultDate:this.props.time});this.$time.on('change.datetimepicker',function(e){if(e.date){_this2.props.onChangeTime(e.date.valueOf());}});}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){this.$time.datetimepicker('destroy');}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps){var _this$props=this.props,time=_this$props.time,useLocalTime=_this$props.useLocalTime;if(prevProps.time!==time){this.$time.datetimepicker('date',time?moment(time):null);}if(prevProps.useLocalTime!==useLocalTime){this.$time.datetimepicker('options',{timeZone:this.timezone(),defaultDate:null});}}},{key:\"render\",value:function render(){var _this3=this;return/*#__PURE__*/React.createElement(InputGroup,{className:\"time-input\",size:\"sm\"},/*#__PURE__*/React.createElement(InputGroupAddon,{addonType:\"prepend\"},/*#__PURE__*/React.createElement(Button,{title:\"Decrease time\",onClick:this.decreaseTime},/*#__PURE__*/React.createElement(FontAwesomeIcon,{icon:faChevronLeft,fixedWidth:true}))),/*#__PURE__*/React.createElement(Input,{placeholder:this.props.placeholder,innerRef:this.timeInputRef,onFocus:function onFocus(){return _this3.$time.datetimepicker('show');},onBlur:function onBlur(){return _this3.$time.datetimepicker('hide');},onKeyDown:function onKeyDown(e){return['Escape','Enter'].includes(e.key)&&_this3.$time.datetimepicker('hide');}}),this.props.time&&/*#__PURE__*/React.createElement(InputGroupAddon,{addonType:\"append\"},/*#__PURE__*/React.createElement(Button,{outline:true,className:\"clear-time-btn\",title:\"Clear time\",onClick:this.clearTime},/*#__PURE__*/React.createElement(FontAwesomeIcon,{icon:faTimes,fixedWidth:true}))),/*#__PURE__*/React.createElement(InputGroupAddon,{addonType:\"append\"},/*#__PURE__*/React.createElement(Button,{title:\"Increase time\",onClick:this.increaseTime},/*#__PURE__*/React.createElement(FontAwesomeIcon,{icon:faChevronRight,fixedWidth:true}))));}}]);return TimeInput;}(Component);export default TimeInput;","map":{"version":3,"sources":["/usr/local/google/home/freinartz/repos/src/github.com/GoogleCloudPlatform/prometheus-clean/web/ui/react-app/src/pages/graph/TimeInput.tsx"],"names":["$","React","Component","Button","InputGroup","InputGroupAddon","Input","moment","dom","library","FontAwesomeIcon","faChevronLeft","faChevronRight","faCalendarCheck","faArrowUp","faArrowDown","faTimes","add","watch","TimeInput","timeInputRef","createRef","$time","getBaseTime","props","time","valueOf","calcShiftRange","range","increaseTime","onChangeTime","decreaseTime","clearTime","timezone","useLocalTime","tz","guess","current","datetimepicker","icons","today","buttons","showClose","showToday","sideBySide","format","locale","timeZone","defaultDate","on","e","date","prevProps","placeholder","includes","key"],"mappings":"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","sourcesContent":["import $ from 'jquery';\nimport React, { Component } from 'react';\nimport { Button, InputGroup, InputGroupAddon, Input } from 'reactstrap';\n\nimport moment from 'moment-timezone';\n\nimport 'tempusdominus-core';\nimport 'tempusdominus-bootstrap-4';\nimport '../../../node_modules/tempusdominus-bootstrap-4/build/css/tempusdominus-bootstrap-4.min.css';\n\nimport { dom, library } from '@fortawesome/fontawesome-svg-core';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  faChevronLeft,\n  faChevronRight,\n  faCalendarCheck,\n  faArrowUp,\n  faArrowDown,\n  faTimes,\n} from '@fortawesome/free-solid-svg-icons';\n\nlibrary.add(faChevronLeft, faChevronRight, faCalendarCheck, faArrowUp, faArrowDown, faTimes);\n// Sadly needed to also replace <i> within the date picker, since it's not a React component.\ndom.watch();\n\ninterface TimeInputProps {\n  time: number | null; // Timestamp in milliseconds.\n  useLocalTime: boolean;\n  range: number; // Range in seconds.\n  placeholder: string;\n  onChangeTime: (time: number | null) => void;\n}\n\nclass TimeInput extends Component<TimeInputProps> {\n  private timeInputRef = React.createRef<HTMLInputElement>();\n  private $time: any = null;\n\n  getBaseTime = (): number => {\n    return this.props.time || moment().valueOf();\n  };\n\n  calcShiftRange = () => this.props.range / 2;\n\n  increaseTime = (): void => {\n    const time = this.getBaseTime() + this.calcShiftRange();\n    this.props.onChangeTime(time);\n  };\n\n  decreaseTime = (): void => {\n    const time = this.getBaseTime() - this.calcShiftRange();\n    this.props.onChangeTime(time);\n  };\n\n  clearTime = (): void => {\n    this.props.onChangeTime(null);\n  };\n\n  timezone = (): string => {\n    return this.props.useLocalTime ? moment.tz.guess() : 'UTC';\n  };\n\n  componentDidMount() {\n    this.$time = $(this.timeInputRef.current!);\n\n    this.$time.datetimepicker({\n      icons: {\n        today: 'fas fa-calendar-check',\n      },\n      buttons: {\n        //showClear: true,\n        showClose: true,\n        showToday: true,\n      },\n      sideBySide: true,\n      format: 'YYYY-MM-DD HH:mm:ss',\n      locale: 'en',\n      timeZone: this.timezone(),\n      defaultDate: this.props.time,\n    });\n\n    this.$time.on('change.datetimepicker', (e: any) => {\n      if (e.date) {\n        this.props.onChangeTime(e.date.valueOf());\n      }\n    });\n  }\n\n  componentWillUnmount() {\n    this.$time.datetimepicker('destroy');\n  }\n\n  componentDidUpdate(prevProps: TimeInputProps) {\n    const { time, useLocalTime } = this.props;\n    if (prevProps.time !== time) {\n      this.$time.datetimepicker('date', time ? moment(time) : null);\n    }\n    if (prevProps.useLocalTime !== useLocalTime) {\n      this.$time.datetimepicker('options', { timeZone: this.timezone(), defaultDate: null });\n    }\n  }\n\n  render() {\n    return (\n      <InputGroup className=\"time-input\" size=\"sm\">\n        <InputGroupAddon addonType=\"prepend\">\n          <Button title=\"Decrease time\" onClick={this.decreaseTime}>\n            <FontAwesomeIcon icon={faChevronLeft} fixedWidth />\n          </Button>\n        </InputGroupAddon>\n\n        <Input\n          placeholder={this.props.placeholder}\n          innerRef={this.timeInputRef}\n          onFocus={() => this.$time.datetimepicker('show')}\n          onBlur={() => this.$time.datetimepicker('hide')}\n          onKeyDown={e => ['Escape', 'Enter'].includes(e.key) && this.$time.datetimepicker('hide')}\n        />\n\n        {/* CAUTION: While the datetimepicker also has an option to show a 'clear' button,\n            that functionality is broken, so we create an external solution instead. */}\n        {this.props.time && (\n          <InputGroupAddon addonType=\"append\">\n            <Button outline className=\"clear-time-btn\" title=\"Clear time\" onClick={this.clearTime}>\n              <FontAwesomeIcon icon={faTimes} fixedWidth />\n            </Button>\n          </InputGroupAddon>\n        )}\n\n        <InputGroupAddon addonType=\"append\">\n          <Button title=\"Increase time\" onClick={this.increaseTime}>\n            <FontAwesomeIcon icon={faChevronRight} fixedWidth />\n          </Button>\n        </InputGroupAddon>\n      </InputGroup>\n    );\n  }\n}\n\nexport default TimeInput;\n"]},"metadata":{},"sourceType":"module"}