{"ast":null,"code":"import _createForOfIteratorHelper from\"/usr/local/google/home/freinartz/repos/src/github.com/GoogleCloudPlatform/prometheus-clean/web/ui/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _classCallCheck from\"/usr/local/google/home/freinartz/repos/src/github.com/GoogleCloudPlatform/prometheus-clean/web/ui/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/usr/local/google/home/freinartz/repos/src/github.com/GoogleCloudPlatform/prometheus-clean/web/ui/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/usr/local/google/home/freinartz/repos/src/github.com/GoogleCloudPlatform/prometheus-clean/web/ui/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/usr/local/google/home/freinartz/repos/src/github.com/GoogleCloudPlatform/prometheus-clean/web/ui/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{Button,ButtonGroup,Form,InputGroup,InputGroupAddon,Input}from'reactstrap';import{FontAwesomeIcon}from'@fortawesome/react-fontawesome';import{faPlus,faMinus,faChartArea,faChartLine}from'@fortawesome/free-solid-svg-icons';import TimeInput from'./TimeInput';import{parseDuration,formatDuration}from'../../utils';var GraphControls=/*#__PURE__*/function(_Component){_inherits(GraphControls,_Component);var _super=_createSuper(GraphControls);function GraphControls(){var _this;_classCallCheck(this,GraphControls);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.rangeRef=React.createRef();_this.resolutionRef=React.createRef();_this.rangeSteps=[1,10,60,5*60,15*60,30*60,60*60,2*60*60,6*60*60,12*60*60,24*60*60,48*60*60,7*24*60*60,14*24*60*60,28*24*60*60,56*24*60*60,112*24*60*60,182*24*60*60,365*24*60*60,730*24*60*60].map(function(s){return s*1000;});_this.onChangeRangeInput=function(rangeText){var range=parseDuration(rangeText);if(range===null){_this.changeRangeInput(_this.props.range);}else{_this.props.onChangeRange(range);}};_this.changeRangeInput=function(range){_this.rangeRef.current.value=formatDuration(range);};_this.increaseRange=function(){var _iterator=_createForOfIteratorHelper(_this.rangeSteps),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var _range=_step.value;if(_this.props.range<_range){_this.changeRangeInput(_range);_this.props.onChangeRange(_range);return;}}}catch(err){_iterator.e(err);}finally{_iterator.f();}};_this.decreaseRange=function(){var _iterator2=_createForOfIteratorHelper(_this.rangeSteps.slice().reverse()),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _range2=_step2.value;if(_this.props.range>_range2){_this.changeRangeInput(_range2);_this.props.onChangeRange(_range2);return;}}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}};return _this;}_createClass(GraphControls,[{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps){if(prevProps.range!==this.props.range){this.changeRangeInput(this.props.range);}if(prevProps.resolution!==this.props.resolution){this.resolutionRef.current.value=this.props.resolution!==null?this.props.resolution.toString():'';}}},{key:\"render\",value:function render(){var _this2=this;return/*#__PURE__*/React.createElement(Form,{inline:true,className:\"graph-controls\",onSubmit:function onSubmit(e){return e.preventDefault();}},/*#__PURE__*/React.createElement(InputGroup,{className:\"range-input\",size:\"sm\"},/*#__PURE__*/React.createElement(InputGroupAddon,{addonType:\"prepend\"},/*#__PURE__*/React.createElement(Button,{title:\"Decrease range\",onClick:this.decreaseRange},/*#__PURE__*/React.createElement(FontAwesomeIcon,{icon:faMinus,fixedWidth:true}))),/*#__PURE__*/React.createElement(Input,{defaultValue:formatDuration(this.props.range),innerRef:this.rangeRef,onBlur:function onBlur(){return _this2.onChangeRangeInput(_this2.rangeRef.current.value);},onKeyDown:function onKeyDown(e){return e.key==='Enter'&&_this2.onChangeRangeInput(_this2.rangeRef.current.value);}}),/*#__PURE__*/React.createElement(InputGroupAddon,{addonType:\"append\"},/*#__PURE__*/React.createElement(Button,{title:\"Increase range\",onClick:this.increaseRange},/*#__PURE__*/React.createElement(FontAwesomeIcon,{icon:faPlus,fixedWidth:true})))),/*#__PURE__*/React.createElement(TimeInput,{time:this.props.endTime,useLocalTime:this.props.useLocalTime,range:this.props.range,placeholder:\"End time\",onChangeTime:this.props.onChangeEndTime}),/*#__PURE__*/React.createElement(Input,{placeholder:\"Res. (s)\",className:\"resolution-input\",defaultValue:this.props.resolution!==null?this.props.resolution.toString():'',innerRef:this.resolutionRef,onBlur:function onBlur(){var res=parseInt(_this2.resolutionRef.current.value);_this2.props.onChangeResolution(res?res:null);},bsSize:\"sm\"}),/*#__PURE__*/React.createElement(ButtonGroup,{className:\"stacked-input\",size:\"sm\"},/*#__PURE__*/React.createElement(Button,{title:\"Show unstacked line graph\",onClick:function onClick(){return _this2.props.onChangeStacking(false);},active:!this.props.stacked},/*#__PURE__*/React.createElement(FontAwesomeIcon,{icon:faChartLine,fixedWidth:true})),/*#__PURE__*/React.createElement(Button,{title:\"Show stacked graph\",onClick:function onClick(){return _this2.props.onChangeStacking(true);},active:this.props.stacked},/*#__PURE__*/React.createElement(FontAwesomeIcon,{icon:faChartArea,fixedWidth:true}))));}}]);return GraphControls;}(Component);export default GraphControls;","map":{"version":3,"sources":["/usr/local/google/home/freinartz/repos/src/github.com/GoogleCloudPlatform/prometheus-clean/web/ui/react-app/src/pages/graph/GraphControls.tsx"],"names":["React","Component","Button","ButtonGroup","Form","InputGroup","InputGroupAddon","Input","FontAwesomeIcon","faPlus","faMinus","faChartArea","faChartLine","TimeInput","parseDuration","formatDuration","GraphControls","rangeRef","createRef","resolutionRef","rangeSteps","map","s","onChangeRangeInput","rangeText","range","changeRangeInput","props","onChangeRange","current","value","increaseRange","decreaseRange","slice","reverse","prevProps","resolution","toString","e","preventDefault","key","endTime","useLocalTime","onChangeEndTime","res","parseInt","onChangeResolution","onChangeStacking","stacked"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { Button, ButtonGroup, Form, InputGroup, InputGroupAddon, Input } from 'reactstrap';\n\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faPlus, faMinus, faChartArea, faChartLine } from '@fortawesome/free-solid-svg-icons';\n\nimport TimeInput from './TimeInput';\nimport { parseDuration, formatDuration } from '../../utils';\n\ninterface GraphControlsProps {\n  range: number;\n  endTime: number | null;\n  useLocalTime: boolean;\n  resolution: number | null;\n  stacked: boolean;\n\n  onChangeRange: (range: number) => void;\n  onChangeEndTime: (endTime: number | null) => void;\n  onChangeResolution: (resolution: number | null) => void;\n  onChangeStacking: (stacked: boolean) => void;\n}\n\nclass GraphControls extends Component<GraphControlsProps> {\n  private rangeRef = React.createRef<HTMLInputElement>();\n  private resolutionRef = React.createRef<HTMLInputElement>();\n\n  rangeSteps = [\n    1,\n    10,\n    60,\n    5 * 60,\n    15 * 60,\n    30 * 60,\n    60 * 60,\n    2 * 60 * 60,\n    6 * 60 * 60,\n    12 * 60 * 60,\n    24 * 60 * 60,\n    48 * 60 * 60,\n    7 * 24 * 60 * 60,\n    14 * 24 * 60 * 60,\n    28 * 24 * 60 * 60,\n    56 * 24 * 60 * 60,\n    112 * 24 * 60 * 60,\n    182 * 24 * 60 * 60,\n    365 * 24 * 60 * 60,\n    730 * 24 * 60 * 60,\n  ].map(s => s * 1000);\n\n  onChangeRangeInput = (rangeText: string): void => {\n    const range = parseDuration(rangeText);\n    if (range === null) {\n      this.changeRangeInput(this.props.range);\n    } else {\n      this.props.onChangeRange(range);\n    }\n  };\n\n  changeRangeInput = (range: number): void => {\n    this.rangeRef.current!.value = formatDuration(range);\n  };\n\n  increaseRange = (): void => {\n    for (const range of this.rangeSteps) {\n      if (this.props.range < range) {\n        this.changeRangeInput(range);\n        this.props.onChangeRange(range);\n        return;\n      }\n    }\n  };\n\n  decreaseRange = (): void => {\n    for (const range of this.rangeSteps.slice().reverse()) {\n      if (this.props.range > range) {\n        this.changeRangeInput(range);\n        this.props.onChangeRange(range);\n        return;\n      }\n    }\n  };\n\n  componentDidUpdate(prevProps: GraphControlsProps) {\n    if (prevProps.range !== this.props.range) {\n      this.changeRangeInput(this.props.range);\n    }\n    if (prevProps.resolution !== this.props.resolution) {\n      this.resolutionRef.current!.value = this.props.resolution !== null ? this.props.resolution.toString() : '';\n    }\n  }\n\n  render() {\n    return (\n      <Form inline className=\"graph-controls\" onSubmit={e => e.preventDefault()}>\n        <InputGroup className=\"range-input\" size=\"sm\">\n          <InputGroupAddon addonType=\"prepend\">\n            <Button title=\"Decrease range\" onClick={this.decreaseRange}>\n              <FontAwesomeIcon icon={faMinus} fixedWidth />\n            </Button>\n          </InputGroupAddon>\n\n          <Input\n            defaultValue={formatDuration(this.props.range)}\n            innerRef={this.rangeRef}\n            onBlur={() => this.onChangeRangeInput(this.rangeRef.current!.value)}\n            onKeyDown={(e: React.KeyboardEvent<HTMLInputElement>) =>\n              e.key === 'Enter' && this.onChangeRangeInput(this.rangeRef.current!.value)\n            }\n          />\n\n          <InputGroupAddon addonType=\"append\">\n            <Button title=\"Increase range\" onClick={this.increaseRange}>\n              <FontAwesomeIcon icon={faPlus} fixedWidth />\n            </Button>\n          </InputGroupAddon>\n        </InputGroup>\n\n        <TimeInput\n          time={this.props.endTime}\n          useLocalTime={this.props.useLocalTime}\n          range={this.props.range}\n          placeholder=\"End time\"\n          onChangeTime={this.props.onChangeEndTime}\n        />\n\n        <Input\n          placeholder=\"Res. (s)\"\n          className=\"resolution-input\"\n          defaultValue={this.props.resolution !== null ? this.props.resolution.toString() : ''}\n          innerRef={this.resolutionRef}\n          onBlur={() => {\n            const res = parseInt(this.resolutionRef.current!.value);\n            this.props.onChangeResolution(res ? res : null);\n          }}\n          bsSize=\"sm\"\n        />\n\n        <ButtonGroup className=\"stacked-input\" size=\"sm\">\n          <Button\n            title=\"Show unstacked line graph\"\n            onClick={() => this.props.onChangeStacking(false)}\n            active={!this.props.stacked}\n          >\n            <FontAwesomeIcon icon={faChartLine} fixedWidth />\n          </Button>\n          <Button title=\"Show stacked graph\" onClick={() => this.props.onChangeStacking(true)} active={this.props.stacked}>\n            <FontAwesomeIcon icon={faChartArea} fixedWidth />\n          </Button>\n        </ButtonGroup>\n      </Form>\n    );\n  }\n}\n\nexport default GraphControls;\n"]},"metadata":{},"sourceType":"module"}