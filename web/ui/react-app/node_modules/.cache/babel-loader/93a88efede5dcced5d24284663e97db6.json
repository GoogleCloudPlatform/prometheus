{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar decode_codepoint_1 = __importDefault(require(\"entities/lib/decode_codepoint\"));\n\nvar entities_json_1 = __importDefault(require(\"entities/lib/maps/entities.json\"));\n\nvar legacy_json_1 = __importDefault(require(\"entities/lib/maps/legacy.json\"));\n\nvar xml_json_1 = __importDefault(require(\"entities/lib/maps/xml.json\"));\n\nfunction whitespace(c) {\n  return c === \" \" || c === \"\\n\" || c === \"\\t\" || c === \"\\f\" || c === \"\\r\";\n}\n\nfunction isASCIIAlpha(c) {\n  return c >= \"a\" && c <= \"z\" || c >= \"A\" && c <= \"Z\";\n}\n\nfunction ifElseState(upper, SUCCESS, FAILURE) {\n  var lower = upper.toLowerCase();\n\n  if (upper === lower) {\n    return function (t, c) {\n      if (c === lower) {\n        t._state = SUCCESS;\n      } else {\n        t._state = FAILURE;\n        t._index--;\n      }\n    };\n  }\n\n  return function (t, c) {\n    if (c === lower || c === upper) {\n      t._state = SUCCESS;\n    } else {\n      t._state = FAILURE;\n      t._index--;\n    }\n  };\n}\n\nfunction consumeSpecialNameChar(upper, NEXT_STATE) {\n  var lower = upper.toLowerCase();\n  return function (t, c) {\n    if (c === lower || c === upper) {\n      t._state = NEXT_STATE;\n    } else {\n      t._state = 3\n      /* InTagName */\n      ;\n      t._index--; // Consume the token again\n    }\n  };\n}\n\nvar stateBeforeCdata1 = ifElseState(\"C\", 24\n/* BeforeCdata2 */\n, 16\n/* InDeclaration */\n);\nvar stateBeforeCdata2 = ifElseState(\"D\", 25\n/* BeforeCdata3 */\n, 16\n/* InDeclaration */\n);\nvar stateBeforeCdata3 = ifElseState(\"A\", 26\n/* BeforeCdata4 */\n, 16\n/* InDeclaration */\n);\nvar stateBeforeCdata4 = ifElseState(\"T\", 27\n/* BeforeCdata5 */\n, 16\n/* InDeclaration */\n);\nvar stateBeforeCdata5 = ifElseState(\"A\", 28\n/* BeforeCdata6 */\n, 16\n/* InDeclaration */\n);\nvar stateBeforeScript1 = consumeSpecialNameChar(\"R\", 35\n/* BeforeScript2 */\n);\nvar stateBeforeScript2 = consumeSpecialNameChar(\"I\", 36\n/* BeforeScript3 */\n);\nvar stateBeforeScript3 = consumeSpecialNameChar(\"P\", 37\n/* BeforeScript4 */\n);\nvar stateBeforeScript4 = consumeSpecialNameChar(\"T\", 38\n/* BeforeScript5 */\n);\nvar stateAfterScript1 = ifElseState(\"R\", 40\n/* AfterScript2 */\n, 1\n/* Text */\n);\nvar stateAfterScript2 = ifElseState(\"I\", 41\n/* AfterScript3 */\n, 1\n/* Text */\n);\nvar stateAfterScript3 = ifElseState(\"P\", 42\n/* AfterScript4 */\n, 1\n/* Text */\n);\nvar stateAfterScript4 = ifElseState(\"T\", 43\n/* AfterScript5 */\n, 1\n/* Text */\n);\nvar stateBeforeStyle1 = consumeSpecialNameChar(\"Y\", 45\n/* BeforeStyle2 */\n);\nvar stateBeforeStyle2 = consumeSpecialNameChar(\"L\", 46\n/* BeforeStyle3 */\n);\nvar stateBeforeStyle3 = consumeSpecialNameChar(\"E\", 47\n/* BeforeStyle4 */\n);\nvar stateAfterStyle1 = ifElseState(\"Y\", 49\n/* AfterStyle2 */\n, 1\n/* Text */\n);\nvar stateAfterStyle2 = ifElseState(\"L\", 50\n/* AfterStyle3 */\n, 1\n/* Text */\n);\nvar stateAfterStyle3 = ifElseState(\"E\", 51\n/* AfterStyle4 */\n, 1\n/* Text */\n);\nvar stateBeforeSpecialT = consumeSpecialNameChar(\"I\", 54\n/* BeforeTitle1 */\n);\nvar stateBeforeTitle1 = consumeSpecialNameChar(\"T\", 55\n/* BeforeTitle2 */\n);\nvar stateBeforeTitle2 = consumeSpecialNameChar(\"L\", 56\n/* BeforeTitle3 */\n);\nvar stateBeforeTitle3 = consumeSpecialNameChar(\"E\", 57\n/* BeforeTitle4 */\n);\nvar stateAfterSpecialTEnd = ifElseState(\"I\", 58\n/* AfterTitle1 */\n, 1\n/* Text */\n);\nvar stateAfterTitle1 = ifElseState(\"T\", 59\n/* AfterTitle2 */\n, 1\n/* Text */\n);\nvar stateAfterTitle2 = ifElseState(\"L\", 60\n/* AfterTitle3 */\n, 1\n/* Text */\n);\nvar stateAfterTitle3 = ifElseState(\"E\", 61\n/* AfterTitle4 */\n, 1\n/* Text */\n);\nvar stateBeforeEntity = ifElseState(\"#\", 63\n/* BeforeNumericEntity */\n, 64\n/* InNamedEntity */\n);\nvar stateBeforeNumericEntity = ifElseState(\"X\", 66\n/* InHexEntity */\n, 65\n/* InNumericEntity */\n);\n\nvar Tokenizer =\n/** @class */\nfunction () {\n  function Tokenizer(options, cbs) {\n    var _a;\n    /** The current state the tokenizer is in. */\n\n\n    this._state = 1\n    /* Text */\n    ;\n    /** The read buffer. */\n\n    this.buffer = \"\";\n    /** The beginning of the section that is currently being read. */\n\n    this.sectionStart = 0;\n    /** The index within the buffer that we are currently looking at. */\n\n    this._index = 0;\n    /**\n     * Data that has already been processed will be removed from the buffer occasionally.\n     * `_bufferOffset` keeps track of how many characters have been removed, to make sure position information is accurate.\n     */\n\n    this.bufferOffset = 0;\n    /** Some behavior, eg. when decoding entities, is done while we are in another state. This keeps track of the other state type. */\n\n    this.baseState = 1\n    /* Text */\n    ;\n    /** For special parsing behavior inside of script and style tags. */\n\n    this.special = 1\n    /* None */\n    ;\n    /** Indicates whether the tokenizer has been paused. */\n\n    this.running = true;\n    /** Indicates whether the tokenizer has finished running / `.end` has been called. */\n\n    this.ended = false;\n    this.cbs = cbs;\n    this.xmlMode = !!(options === null || options === void 0 ? void 0 : options.xmlMode);\n    this.decodeEntities = (_a = options === null || options === void 0 ? void 0 : options.decodeEntities) !== null && _a !== void 0 ? _a : true;\n  }\n\n  Tokenizer.prototype.reset = function () {\n    this._state = 1\n    /* Text */\n    ;\n    this.buffer = \"\";\n    this.sectionStart = 0;\n    this._index = 0;\n    this.bufferOffset = 0;\n    this.baseState = 1\n    /* Text */\n    ;\n    this.special = 1\n    /* None */\n    ;\n    this.running = true;\n    this.ended = false;\n  };\n\n  Tokenizer.prototype.write = function (chunk) {\n    if (this.ended) this.cbs.onerror(Error(\".write() after done!\"));\n    this.buffer += chunk;\n    this.parse();\n  };\n\n  Tokenizer.prototype.end = function (chunk) {\n    if (this.ended) this.cbs.onerror(Error(\".end() after done!\"));\n    if (chunk) this.write(chunk);\n    this.ended = true;\n    if (this.running) this.finish();\n  };\n\n  Tokenizer.prototype.pause = function () {\n    this.running = false;\n  };\n\n  Tokenizer.prototype.resume = function () {\n    this.running = true;\n\n    if (this._index < this.buffer.length) {\n      this.parse();\n    }\n\n    if (this.ended) {\n      this.finish();\n    }\n  };\n  /**\n   * The current index within all of the written data.\n   */\n\n\n  Tokenizer.prototype.getAbsoluteIndex = function () {\n    return this.bufferOffset + this._index;\n  };\n\n  Tokenizer.prototype.stateText = function (c) {\n    if (c === \"<\") {\n      if (this._index > this.sectionStart) {\n        this.cbs.ontext(this.getSection());\n      }\n\n      this._state = 2\n      /* BeforeTagName */\n      ;\n      this.sectionStart = this._index;\n    } else if (this.decodeEntities && c === \"&\" && (this.special === 1\n    /* None */\n    || this.special === 4\n    /* Title */\n    )) {\n      if (this._index > this.sectionStart) {\n        this.cbs.ontext(this.getSection());\n      }\n\n      this.baseState = 1\n      /* Text */\n      ;\n      this._state = 62\n      /* BeforeEntity */\n      ;\n      this.sectionStart = this._index;\n    }\n  };\n  /**\n   * HTML only allows ASCII alpha characters (a-z and A-Z) at the beginning of a tag name.\n   *\n   * XML allows a lot more characters here (@see https://www.w3.org/TR/REC-xml/#NT-NameStartChar).\n   * We allow anything that wouldn't end the tag.\n   */\n\n\n  Tokenizer.prototype.isTagStartChar = function (c) {\n    return isASCIIAlpha(c) || this.xmlMode && !whitespace(c) && c !== \"/\" && c !== \">\";\n  };\n\n  Tokenizer.prototype.stateBeforeTagName = function (c) {\n    if (c === \"/\") {\n      this._state = 5\n      /* BeforeClosingTagName */\n      ;\n    } else if (c === \"<\") {\n      this.cbs.ontext(this.getSection());\n      this.sectionStart = this._index;\n    } else if (c === \">\" || this.special !== 1\n    /* None */\n    || whitespace(c)) {\n      this._state = 1\n      /* Text */\n      ;\n    } else if (c === \"!\") {\n      this._state = 15\n      /* BeforeDeclaration */\n      ;\n      this.sectionStart = this._index + 1;\n    } else if (c === \"?\") {\n      this._state = 17\n      /* InProcessingInstruction */\n      ;\n      this.sectionStart = this._index + 1;\n    } else if (!this.isTagStartChar(c)) {\n      this._state = 1\n      /* Text */\n      ;\n    } else {\n      this._state = !this.xmlMode && (c === \"s\" || c === \"S\") ? 32\n      /* BeforeSpecialS */\n      : !this.xmlMode && (c === \"t\" || c === \"T\") ? 52\n      /* BeforeSpecialT */\n      : 3\n      /* InTagName */\n      ;\n      this.sectionStart = this._index;\n    }\n  };\n\n  Tokenizer.prototype.stateInTagName = function (c) {\n    if (c === \"/\" || c === \">\" || whitespace(c)) {\n      this.emitToken(\"onopentagname\");\n      this._state = 8\n      /* BeforeAttributeName */\n      ;\n      this._index--;\n    }\n  };\n\n  Tokenizer.prototype.stateBeforeClosingTagName = function (c) {\n    if (whitespace(c)) {// Ignore\n    } else if (c === \">\") {\n      this._state = 1\n      /* Text */\n      ;\n    } else if (this.special !== 1\n    /* None */\n    ) {\n        if (this.special !== 4\n        /* Title */\n        && (c === \"s\" || c === \"S\")) {\n          this._state = 33\n          /* BeforeSpecialSEnd */\n          ;\n        } else if (this.special === 4\n        /* Title */\n        && (c === \"t\" || c === \"T\")) {\n          this._state = 53\n          /* BeforeSpecialTEnd */\n          ;\n        } else {\n          this._state = 1\n          /* Text */\n          ;\n          this._index--;\n        }\n      } else if (!this.isTagStartChar(c)) {\n      this._state = 20\n      /* InSpecialComment */\n      ;\n      this.sectionStart = this._index;\n    } else {\n      this._state = 6\n      /* InClosingTagName */\n      ;\n      this.sectionStart = this._index;\n    }\n  };\n\n  Tokenizer.prototype.stateInClosingTagName = function (c) {\n    if (c === \">\" || whitespace(c)) {\n      this.emitToken(\"onclosetag\");\n      this._state = 7\n      /* AfterClosingTagName */\n      ;\n      this._index--;\n    }\n  };\n\n  Tokenizer.prototype.stateAfterClosingTagName = function (c) {\n    // Skip everything until \">\"\n    if (c === \">\") {\n      this._state = 1\n      /* Text */\n      ;\n      this.sectionStart = this._index + 1;\n    }\n  };\n\n  Tokenizer.prototype.stateBeforeAttributeName = function (c) {\n    if (c === \">\") {\n      this.cbs.onopentagend();\n      this._state = 1\n      /* Text */\n      ;\n      this.sectionStart = this._index + 1;\n    } else if (c === \"/\") {\n      this._state = 4\n      /* InSelfClosingTag */\n      ;\n    } else if (!whitespace(c)) {\n      this._state = 9\n      /* InAttributeName */\n      ;\n      this.sectionStart = this._index;\n    }\n  };\n\n  Tokenizer.prototype.stateInSelfClosingTag = function (c) {\n    if (c === \">\") {\n      this.cbs.onselfclosingtag();\n      this._state = 1\n      /* Text */\n      ;\n      this.sectionStart = this._index + 1;\n      this.special = 1\n      /* None */\n      ; // Reset special state, in case of self-closing special tags\n    } else if (!whitespace(c)) {\n      this._state = 8\n      /* BeforeAttributeName */\n      ;\n      this._index--;\n    }\n  };\n\n  Tokenizer.prototype.stateInAttributeName = function (c) {\n    if (c === \"=\" || c === \"/\" || c === \">\" || whitespace(c)) {\n      this.cbs.onattribname(this.getSection());\n      this.sectionStart = -1;\n      this._state = 10\n      /* AfterAttributeName */\n      ;\n      this._index--;\n    }\n  };\n\n  Tokenizer.prototype.stateAfterAttributeName = function (c) {\n    if (c === \"=\") {\n      this._state = 11\n      /* BeforeAttributeValue */\n      ;\n    } else if (c === \"/\" || c === \">\") {\n      this.cbs.onattribend(undefined);\n      this._state = 8\n      /* BeforeAttributeName */\n      ;\n      this._index--;\n    } else if (!whitespace(c)) {\n      this.cbs.onattribend(undefined);\n      this._state = 9\n      /* InAttributeName */\n      ;\n      this.sectionStart = this._index;\n    }\n  };\n\n  Tokenizer.prototype.stateBeforeAttributeValue = function (c) {\n    if (c === '\"') {\n      this._state = 12\n      /* InAttributeValueDq */\n      ;\n      this.sectionStart = this._index + 1;\n    } else if (c === \"'\") {\n      this._state = 13\n      /* InAttributeValueSq */\n      ;\n      this.sectionStart = this._index + 1;\n    } else if (!whitespace(c)) {\n      this._state = 14\n      /* InAttributeValueNq */\n      ;\n      this.sectionStart = this._index;\n      this._index--; // Reconsume token\n    }\n  };\n\n  Tokenizer.prototype.handleInAttributeValue = function (c, quote) {\n    if (c === quote) {\n      this.emitToken(\"onattribdata\");\n      this.cbs.onattribend(quote);\n      this._state = 8\n      /* BeforeAttributeName */\n      ;\n    } else if (this.decodeEntities && c === \"&\") {\n      this.emitToken(\"onattribdata\");\n      this.baseState = this._state;\n      this._state = 62\n      /* BeforeEntity */\n      ;\n      this.sectionStart = this._index;\n    }\n  };\n\n  Tokenizer.prototype.stateInAttributeValueDoubleQuotes = function (c) {\n    this.handleInAttributeValue(c, '\"');\n  };\n\n  Tokenizer.prototype.stateInAttributeValueSingleQuotes = function (c) {\n    this.handleInAttributeValue(c, \"'\");\n  };\n\n  Tokenizer.prototype.stateInAttributeValueNoQuotes = function (c) {\n    if (whitespace(c) || c === \">\") {\n      this.emitToken(\"onattribdata\");\n      this.cbs.onattribend(null);\n      this._state = 8\n      /* BeforeAttributeName */\n      ;\n      this._index--;\n    } else if (this.decodeEntities && c === \"&\") {\n      this.emitToken(\"onattribdata\");\n      this.baseState = this._state;\n      this._state = 62\n      /* BeforeEntity */\n      ;\n      this.sectionStart = this._index;\n    }\n  };\n\n  Tokenizer.prototype.stateBeforeDeclaration = function (c) {\n    this._state = c === \"[\" ? 23\n    /* BeforeCdata1 */\n    : c === \"-\" ? 18\n    /* BeforeComment */\n    : 16\n    /* InDeclaration */\n    ;\n  };\n\n  Tokenizer.prototype.stateInDeclaration = function (c) {\n    if (c === \">\") {\n      this.cbs.ondeclaration(this.getSection());\n      this._state = 1\n      /* Text */\n      ;\n      this.sectionStart = this._index + 1;\n    }\n  };\n\n  Tokenizer.prototype.stateInProcessingInstruction = function (c) {\n    if (c === \">\") {\n      this.cbs.onprocessinginstruction(this.getSection());\n      this._state = 1\n      /* Text */\n      ;\n      this.sectionStart = this._index + 1;\n    }\n  };\n\n  Tokenizer.prototype.stateBeforeComment = function (c) {\n    if (c === \"-\") {\n      this._state = 19\n      /* InComment */\n      ;\n      this.sectionStart = this._index + 1;\n    } else {\n      this._state = 16\n      /* InDeclaration */\n      ;\n    }\n  };\n\n  Tokenizer.prototype.stateInComment = function (c) {\n    if (c === \"-\") this._state = 21\n    /* AfterComment1 */\n    ;\n  };\n\n  Tokenizer.prototype.stateInSpecialComment = function (c) {\n    if (c === \">\") {\n      this.cbs.oncomment(this.buffer.substring(this.sectionStart, this._index));\n      this._state = 1\n      /* Text */\n      ;\n      this.sectionStart = this._index + 1;\n    }\n  };\n\n  Tokenizer.prototype.stateAfterComment1 = function (c) {\n    if (c === \"-\") {\n      this._state = 22\n      /* AfterComment2 */\n      ;\n    } else {\n      this._state = 19\n      /* InComment */\n      ;\n    }\n  };\n\n  Tokenizer.prototype.stateAfterComment2 = function (c) {\n    if (c === \">\") {\n      // Remove 2 trailing chars\n      this.cbs.oncomment(this.buffer.substring(this.sectionStart, this._index - 2));\n      this._state = 1\n      /* Text */\n      ;\n      this.sectionStart = this._index + 1;\n    } else if (c !== \"-\") {\n      this._state = 19\n      /* InComment */\n      ;\n    } // Else: stay in AFTER_COMMENT_2 (`--->`)\n\n  };\n\n  Tokenizer.prototype.stateBeforeCdata6 = function (c) {\n    if (c === \"[\") {\n      this._state = 29\n      /* InCdata */\n      ;\n      this.sectionStart = this._index + 1;\n    } else {\n      this._state = 16\n      /* InDeclaration */\n      ;\n      this._index--;\n    }\n  };\n\n  Tokenizer.prototype.stateInCdata = function (c) {\n    if (c === \"]\") this._state = 30\n    /* AfterCdata1 */\n    ;\n  };\n\n  Tokenizer.prototype.stateAfterCdata1 = function (c) {\n    if (c === \"]\") this._state = 31\n    /* AfterCdata2 */\n    ;else this._state = 29\n    /* InCdata */\n    ;\n  };\n\n  Tokenizer.prototype.stateAfterCdata2 = function (c) {\n    if (c === \">\") {\n      // Remove 2 trailing chars\n      this.cbs.oncdata(this.buffer.substring(this.sectionStart, this._index - 2));\n      this._state = 1\n      /* Text */\n      ;\n      this.sectionStart = this._index + 1;\n    } else if (c !== \"]\") {\n      this._state = 29\n      /* InCdata */\n      ;\n    } // Else: stay in AFTER_CDATA_2 (`]]]>`)\n\n  };\n\n  Tokenizer.prototype.stateBeforeSpecialS = function (c) {\n    if (c === \"c\" || c === \"C\") {\n      this._state = 34\n      /* BeforeScript1 */\n      ;\n    } else if (c === \"t\" || c === \"T\") {\n      this._state = 44\n      /* BeforeStyle1 */\n      ;\n    } else {\n      this._state = 3\n      /* InTagName */\n      ;\n      this._index--; // Consume the token again\n    }\n  };\n\n  Tokenizer.prototype.stateBeforeSpecialSEnd = function (c) {\n    if (this.special === 2\n    /* Script */\n    && (c === \"c\" || c === \"C\")) {\n      this._state = 39\n      /* AfterScript1 */\n      ;\n    } else if (this.special === 3\n    /* Style */\n    && (c === \"t\" || c === \"T\")) {\n      this._state = 48\n      /* AfterStyle1 */\n      ;\n    } else this._state = 1\n    /* Text */\n    ;\n  };\n\n  Tokenizer.prototype.stateBeforeSpecialLast = function (c, special) {\n    if (c === \"/\" || c === \">\" || whitespace(c)) {\n      this.special = special;\n    }\n\n    this._state = 3\n    /* InTagName */\n    ;\n    this._index--; // Consume the token again\n  };\n\n  Tokenizer.prototype.stateAfterSpecialLast = function (c, sectionStartOffset) {\n    if (c === \">\" || whitespace(c)) {\n      this.special = 1\n      /* None */\n      ;\n      this._state = 6\n      /* InClosingTagName */\n      ;\n      this.sectionStart = this._index - sectionStartOffset;\n      this._index--; // Reconsume the token\n    } else this._state = 1\n    /* Text */\n    ;\n  }; // For entities terminated with a semicolon\n\n\n  Tokenizer.prototype.parseFixedEntity = function (map) {\n    if (map === void 0) {\n      map = this.xmlMode ? xml_json_1.default : entities_json_1.default;\n    } // Offset = 1\n\n\n    if (this.sectionStart + 1 < this._index) {\n      var entity = this.buffer.substring(this.sectionStart + 1, this._index);\n\n      if (Object.prototype.hasOwnProperty.call(map, entity)) {\n        this.emitPartial(map[entity]);\n        this.sectionStart = this._index + 1;\n      }\n    }\n  }; // Parses legacy entities (without trailing semicolon)\n\n\n  Tokenizer.prototype.parseLegacyEntity = function () {\n    var start = this.sectionStart + 1; // The max length of legacy entities is 6\n\n    var limit = Math.min(this._index - start, 6);\n\n    while (limit >= 2) {\n      // The min length of legacy entities is 2\n      var entity = this.buffer.substr(start, limit);\n\n      if (Object.prototype.hasOwnProperty.call(legacy_json_1.default, entity)) {\n        this.emitPartial(legacy_json_1.default[entity]);\n        this.sectionStart += limit + 1;\n        return;\n      }\n\n      limit--;\n    }\n  };\n\n  Tokenizer.prototype.stateInNamedEntity = function (c) {\n    if (c === \";\") {\n      this.parseFixedEntity(); // Retry as legacy entity if entity wasn't parsed\n\n      if (this.baseState === 1\n      /* Text */\n      && this.sectionStart + 1 < this._index && !this.xmlMode) {\n        this.parseLegacyEntity();\n      }\n\n      this._state = this.baseState;\n    } else if ((c < \"0\" || c > \"9\") && !isASCIIAlpha(c)) {\n      if (this.xmlMode || this.sectionStart + 1 === this._index) {// Ignore\n      } else if (this.baseState !== 1\n      /* Text */\n      ) {\n          if (c !== \"=\") {\n            // Parse as legacy entity, without allowing additional characters.\n            this.parseFixedEntity(legacy_json_1.default);\n          }\n        } else {\n        this.parseLegacyEntity();\n      }\n\n      this._state = this.baseState;\n      this._index--;\n    }\n  };\n\n  Tokenizer.prototype.decodeNumericEntity = function (offset, base, strict) {\n    var sectionStart = this.sectionStart + offset;\n\n    if (sectionStart !== this._index) {\n      // Parse entity\n      var entity = this.buffer.substring(sectionStart, this._index);\n      var parsed = parseInt(entity, base);\n      this.emitPartial(decode_codepoint_1.default(parsed));\n      this.sectionStart = strict ? this._index + 1 : this._index;\n    }\n\n    this._state = this.baseState;\n  };\n\n  Tokenizer.prototype.stateInNumericEntity = function (c) {\n    if (c === \";\") {\n      this.decodeNumericEntity(2, 10, true);\n    } else if (c < \"0\" || c > \"9\") {\n      if (!this.xmlMode) {\n        this.decodeNumericEntity(2, 10, false);\n      } else {\n        this._state = this.baseState;\n      }\n\n      this._index--;\n    }\n  };\n\n  Tokenizer.prototype.stateInHexEntity = function (c) {\n    if (c === \";\") {\n      this.decodeNumericEntity(3, 16, true);\n    } else if ((c < \"a\" || c > \"f\") && (c < \"A\" || c > \"F\") && (c < \"0\" || c > \"9\")) {\n      if (!this.xmlMode) {\n        this.decodeNumericEntity(3, 16, false);\n      } else {\n        this._state = this.baseState;\n      }\n\n      this._index--;\n    }\n  };\n\n  Tokenizer.prototype.cleanup = function () {\n    if (this.sectionStart < 0) {\n      this.buffer = \"\";\n      this.bufferOffset += this._index;\n      this._index = 0;\n    } else if (this.running) {\n      if (this._state === 1\n      /* Text */\n      ) {\n          if (this.sectionStart !== this._index) {\n            this.cbs.ontext(this.buffer.substr(this.sectionStart));\n          }\n\n          this.buffer = \"\";\n          this.bufferOffset += this._index;\n          this._index = 0;\n        } else if (this.sectionStart === this._index) {\n        // The section just started\n        this.buffer = \"\";\n        this.bufferOffset += this._index;\n        this._index = 0;\n      } else {\n        // Remove everything unnecessary\n        this.buffer = this.buffer.substr(this.sectionStart);\n        this._index -= this.sectionStart;\n        this.bufferOffset += this.sectionStart;\n      }\n\n      this.sectionStart = 0;\n    }\n  };\n  /**\n   * Iterates through the buffer, calling the function corresponding to the current state.\n   *\n   * States that are more likely to be hit are higher up, as a performance improvement.\n   */\n\n\n  Tokenizer.prototype.parse = function () {\n    while (this._index < this.buffer.length && this.running) {\n      var c = this.buffer.charAt(this._index);\n\n      if (this._state === 1\n      /* Text */\n      ) {\n          this.stateText(c);\n        } else if (this._state === 12\n      /* InAttributeValueDq */\n      ) {\n          this.stateInAttributeValueDoubleQuotes(c);\n        } else if (this._state === 9\n      /* InAttributeName */\n      ) {\n          this.stateInAttributeName(c);\n        } else if (this._state === 19\n      /* InComment */\n      ) {\n          this.stateInComment(c);\n        } else if (this._state === 20\n      /* InSpecialComment */\n      ) {\n          this.stateInSpecialComment(c);\n        } else if (this._state === 8\n      /* BeforeAttributeName */\n      ) {\n          this.stateBeforeAttributeName(c);\n        } else if (this._state === 3\n      /* InTagName */\n      ) {\n          this.stateInTagName(c);\n        } else if (this._state === 6\n      /* InClosingTagName */\n      ) {\n          this.stateInClosingTagName(c);\n        } else if (this._state === 2\n      /* BeforeTagName */\n      ) {\n          this.stateBeforeTagName(c);\n        } else if (this._state === 10\n      /* AfterAttributeName */\n      ) {\n          this.stateAfterAttributeName(c);\n        } else if (this._state === 13\n      /* InAttributeValueSq */\n      ) {\n          this.stateInAttributeValueSingleQuotes(c);\n        } else if (this._state === 11\n      /* BeforeAttributeValue */\n      ) {\n          this.stateBeforeAttributeValue(c);\n        } else if (this._state === 5\n      /* BeforeClosingTagName */\n      ) {\n          this.stateBeforeClosingTagName(c);\n        } else if (this._state === 7\n      /* AfterClosingTagName */\n      ) {\n          this.stateAfterClosingTagName(c);\n        } else if (this._state === 32\n      /* BeforeSpecialS */\n      ) {\n          this.stateBeforeSpecialS(c);\n        } else if (this._state === 21\n      /* AfterComment1 */\n      ) {\n          this.stateAfterComment1(c);\n        } else if (this._state === 14\n      /* InAttributeValueNq */\n      ) {\n          this.stateInAttributeValueNoQuotes(c);\n        } else if (this._state === 4\n      /* InSelfClosingTag */\n      ) {\n          this.stateInSelfClosingTag(c);\n        } else if (this._state === 16\n      /* InDeclaration */\n      ) {\n          this.stateInDeclaration(c);\n        } else if (this._state === 15\n      /* BeforeDeclaration */\n      ) {\n          this.stateBeforeDeclaration(c);\n        } else if (this._state === 22\n      /* AfterComment2 */\n      ) {\n          this.stateAfterComment2(c);\n        } else if (this._state === 18\n      /* BeforeComment */\n      ) {\n          this.stateBeforeComment(c);\n        } else if (this._state === 33\n      /* BeforeSpecialSEnd */\n      ) {\n          this.stateBeforeSpecialSEnd(c);\n        } else if (this._state === 53\n      /* BeforeSpecialTEnd */\n      ) {\n          stateAfterSpecialTEnd(this, c);\n        } else if (this._state === 39\n      /* AfterScript1 */\n      ) {\n          stateAfterScript1(this, c);\n        } else if (this._state === 40\n      /* AfterScript2 */\n      ) {\n          stateAfterScript2(this, c);\n        } else if (this._state === 41\n      /* AfterScript3 */\n      ) {\n          stateAfterScript3(this, c);\n        } else if (this._state === 34\n      /* BeforeScript1 */\n      ) {\n          stateBeforeScript1(this, c);\n        } else if (this._state === 35\n      /* BeforeScript2 */\n      ) {\n          stateBeforeScript2(this, c);\n        } else if (this._state === 36\n      /* BeforeScript3 */\n      ) {\n          stateBeforeScript3(this, c);\n        } else if (this._state === 37\n      /* BeforeScript4 */\n      ) {\n          stateBeforeScript4(this, c);\n        } else if (this._state === 38\n      /* BeforeScript5 */\n      ) {\n          this.stateBeforeSpecialLast(c, 2\n          /* Script */\n          );\n        } else if (this._state === 42\n      /* AfterScript4 */\n      ) {\n          stateAfterScript4(this, c);\n        } else if (this._state === 43\n      /* AfterScript5 */\n      ) {\n          this.stateAfterSpecialLast(c, 6);\n        } else if (this._state === 44\n      /* BeforeStyle1 */\n      ) {\n          stateBeforeStyle1(this, c);\n        } else if (this._state === 29\n      /* InCdata */\n      ) {\n          this.stateInCdata(c);\n        } else if (this._state === 45\n      /* BeforeStyle2 */\n      ) {\n          stateBeforeStyle2(this, c);\n        } else if (this._state === 46\n      /* BeforeStyle3 */\n      ) {\n          stateBeforeStyle3(this, c);\n        } else if (this._state === 47\n      /* BeforeStyle4 */\n      ) {\n          this.stateBeforeSpecialLast(c, 3\n          /* Style */\n          );\n        } else if (this._state === 48\n      /* AfterStyle1 */\n      ) {\n          stateAfterStyle1(this, c);\n        } else if (this._state === 49\n      /* AfterStyle2 */\n      ) {\n          stateAfterStyle2(this, c);\n        } else if (this._state === 50\n      /* AfterStyle3 */\n      ) {\n          stateAfterStyle3(this, c);\n        } else if (this._state === 51\n      /* AfterStyle4 */\n      ) {\n          this.stateAfterSpecialLast(c, 5);\n        } else if (this._state === 52\n      /* BeforeSpecialT */\n      ) {\n          stateBeforeSpecialT(this, c);\n        } else if (this._state === 54\n      /* BeforeTitle1 */\n      ) {\n          stateBeforeTitle1(this, c);\n        } else if (this._state === 55\n      /* BeforeTitle2 */\n      ) {\n          stateBeforeTitle2(this, c);\n        } else if (this._state === 56\n      /* BeforeTitle3 */\n      ) {\n          stateBeforeTitle3(this, c);\n        } else if (this._state === 57\n      /* BeforeTitle4 */\n      ) {\n          this.stateBeforeSpecialLast(c, 4\n          /* Title */\n          );\n        } else if (this._state === 58\n      /* AfterTitle1 */\n      ) {\n          stateAfterTitle1(this, c);\n        } else if (this._state === 59\n      /* AfterTitle2 */\n      ) {\n          stateAfterTitle2(this, c);\n        } else if (this._state === 60\n      /* AfterTitle3 */\n      ) {\n          stateAfterTitle3(this, c);\n        } else if (this._state === 61\n      /* AfterTitle4 */\n      ) {\n          this.stateAfterSpecialLast(c, 5);\n        } else if (this._state === 17\n      /* InProcessingInstruction */\n      ) {\n          this.stateInProcessingInstruction(c);\n        } else if (this._state === 64\n      /* InNamedEntity */\n      ) {\n          this.stateInNamedEntity(c);\n        } else if (this._state === 23\n      /* BeforeCdata1 */\n      ) {\n          stateBeforeCdata1(this, c);\n        } else if (this._state === 62\n      /* BeforeEntity */\n      ) {\n          stateBeforeEntity(this, c);\n        } else if (this._state === 24\n      /* BeforeCdata2 */\n      ) {\n          stateBeforeCdata2(this, c);\n        } else if (this._state === 25\n      /* BeforeCdata3 */\n      ) {\n          stateBeforeCdata3(this, c);\n        } else if (this._state === 30\n      /* AfterCdata1 */\n      ) {\n          this.stateAfterCdata1(c);\n        } else if (this._state === 31\n      /* AfterCdata2 */\n      ) {\n          this.stateAfterCdata2(c);\n        } else if (this._state === 26\n      /* BeforeCdata4 */\n      ) {\n          stateBeforeCdata4(this, c);\n        } else if (this._state === 27\n      /* BeforeCdata5 */\n      ) {\n          stateBeforeCdata5(this, c);\n        } else if (this._state === 28\n      /* BeforeCdata6 */\n      ) {\n          this.stateBeforeCdata6(c);\n        } else if (this._state === 66\n      /* InHexEntity */\n      ) {\n          this.stateInHexEntity(c);\n        } else if (this._state === 65\n      /* InNumericEntity */\n      ) {\n          this.stateInNumericEntity(c); // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n        } else if (this._state === 63\n      /* BeforeNumericEntity */\n      ) {\n          stateBeforeNumericEntity(this, c);\n        } else {\n        this.cbs.onerror(Error(\"unknown _state\"), this._state);\n      }\n\n      this._index++;\n    }\n\n    this.cleanup();\n  };\n\n  Tokenizer.prototype.finish = function () {\n    // If there is remaining data, emit it in a reasonable way\n    if (this.sectionStart < this._index) {\n      this.handleTrailingData();\n    }\n\n    this.cbs.onend();\n  };\n\n  Tokenizer.prototype.handleTrailingData = function () {\n    var data = this.buffer.substr(this.sectionStart);\n\n    if (this._state === 29\n    /* InCdata */\n    || this._state === 30\n    /* AfterCdata1 */\n    || this._state === 31\n    /* AfterCdata2 */\n    ) {\n        this.cbs.oncdata(data);\n      } else if (this._state === 19\n    /* InComment */\n    || this._state === 21\n    /* AfterComment1 */\n    || this._state === 22\n    /* AfterComment2 */\n    ) {\n        this.cbs.oncomment(data);\n      } else if (this._state === 64\n    /* InNamedEntity */\n    && !this.xmlMode) {\n      this.parseLegacyEntity();\n\n      if (this.sectionStart < this._index) {\n        this._state = this.baseState;\n        this.handleTrailingData();\n      }\n    } else if (this._state === 65\n    /* InNumericEntity */\n    && !this.xmlMode) {\n      this.decodeNumericEntity(2, 10, false);\n\n      if (this.sectionStart < this._index) {\n        this._state = this.baseState;\n        this.handleTrailingData();\n      }\n    } else if (this._state === 66\n    /* InHexEntity */\n    && !this.xmlMode) {\n      this.decodeNumericEntity(3, 16, false);\n\n      if (this.sectionStart < this._index) {\n        this._state = this.baseState;\n        this.handleTrailingData();\n      }\n    } else if (this._state !== 3\n    /* InTagName */\n    && this._state !== 8\n    /* BeforeAttributeName */\n    && this._state !== 11\n    /* BeforeAttributeValue */\n    && this._state !== 10\n    /* AfterAttributeName */\n    && this._state !== 9\n    /* InAttributeName */\n    && this._state !== 13\n    /* InAttributeValueSq */\n    && this._state !== 12\n    /* InAttributeValueDq */\n    && this._state !== 14\n    /* InAttributeValueNq */\n    && this._state !== 6\n    /* InClosingTagName */\n    ) {\n        this.cbs.ontext(data);\n      }\n    /*\n     * Else, ignore remaining data\n     * TODO add a way to remove current tag\n     */\n\n  };\n\n  Tokenizer.prototype.getSection = function () {\n    return this.buffer.substring(this.sectionStart, this._index);\n  };\n\n  Tokenizer.prototype.emitToken = function (name) {\n    this.cbs[name](this.getSection());\n    this.sectionStart = -1;\n  };\n\n  Tokenizer.prototype.emitPartial = function (value) {\n    if (this.baseState !== 1\n    /* Text */\n    ) {\n        this.cbs.onattribdata(value); // TODO implement the new event\n      } else {\n      this.cbs.ontext(value);\n    }\n  };\n\n  return Tokenizer;\n}();\n\nexports.default = Tokenizer;","map":{"version":3,"sources":["/usr/local/google/home/freinartz/repos/src/github.com/GoogleCloudPlatform/prometheus-clean/web/ui/react-app/node_modules/htmlparser2/lib/Tokenizer.js"],"names":["__importDefault","mod","__esModule","Object","defineProperty","exports","value","decode_codepoint_1","require","entities_json_1","legacy_json_1","xml_json_1","whitespace","c","isASCIIAlpha","ifElseState","upper","SUCCESS","FAILURE","lower","toLowerCase","t","_state","_index","consumeSpecialNameChar","NEXT_STATE","stateBeforeCdata1","stateBeforeCdata2","stateBeforeCdata3","stateBeforeCdata4","stateBeforeCdata5","stateBeforeScript1","stateBeforeScript2","stateBeforeScript3","stateBeforeScript4","stateAfterScript1","stateAfterScript2","stateAfterScript3","stateAfterScript4","stateBeforeStyle1","stateBeforeStyle2","stateBeforeStyle3","stateAfterStyle1","stateAfterStyle2","stateAfterStyle3","stateBeforeSpecialT","stateBeforeTitle1","stateBeforeTitle2","stateBeforeTitle3","stateAfterSpecialTEnd","stateAfterTitle1","stateAfterTitle2","stateAfterTitle3","stateBeforeEntity","stateBeforeNumericEntity","Tokenizer","options","cbs","_a","buffer","sectionStart","bufferOffset","baseState","special","running","ended","xmlMode","decodeEntities","prototype","reset","write","chunk","onerror","Error","parse","end","finish","pause","resume","length","getAbsoluteIndex","stateText","ontext","getSection","isTagStartChar","stateBeforeTagName","stateInTagName","emitToken","stateBeforeClosingTagName","stateInClosingTagName","stateAfterClosingTagName","stateBeforeAttributeName","onopentagend","stateInSelfClosingTag","onselfclosingtag","stateInAttributeName","onattribname","stateAfterAttributeName","onattribend","undefined","stateBeforeAttributeValue","handleInAttributeValue","quote","stateInAttributeValueDoubleQuotes","stateInAttributeValueSingleQuotes","stateInAttributeValueNoQuotes","stateBeforeDeclaration","stateInDeclaration","ondeclaration","stateInProcessingInstruction","onprocessinginstruction","stateBeforeComment","stateInComment","stateInSpecialComment","oncomment","substring","stateAfterComment1","stateAfterComment2","stateBeforeCdata6","stateInCdata","stateAfterCdata1","stateAfterCdata2","oncdata","stateBeforeSpecialS","stateBeforeSpecialSEnd","stateBeforeSpecialLast","stateAfterSpecialLast","sectionStartOffset","parseFixedEntity","map","default","entity","hasOwnProperty","call","emitPartial","parseLegacyEntity","start","limit","Math","min","substr","stateInNamedEntity","decodeNumericEntity","offset","base","strict","parsed","parseInt","stateInNumericEntity","stateInHexEntity","cleanup","charAt","handleTrailingData","onend","data","name","onattribdata"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar decode_codepoint_1 = __importDefault(require(\"entities/lib/decode_codepoint\"));\nvar entities_json_1 = __importDefault(require(\"entities/lib/maps/entities.json\"));\nvar legacy_json_1 = __importDefault(require(\"entities/lib/maps/legacy.json\"));\nvar xml_json_1 = __importDefault(require(\"entities/lib/maps/xml.json\"));\nfunction whitespace(c) {\n    return c === \" \" || c === \"\\n\" || c === \"\\t\" || c === \"\\f\" || c === \"\\r\";\n}\nfunction isASCIIAlpha(c) {\n    return (c >= \"a\" && c <= \"z\") || (c >= \"A\" && c <= \"Z\");\n}\nfunction ifElseState(upper, SUCCESS, FAILURE) {\n    var lower = upper.toLowerCase();\n    if (upper === lower) {\n        return function (t, c) {\n            if (c === lower) {\n                t._state = SUCCESS;\n            }\n            else {\n                t._state = FAILURE;\n                t._index--;\n            }\n        };\n    }\n    return function (t, c) {\n        if (c === lower || c === upper) {\n            t._state = SUCCESS;\n        }\n        else {\n            t._state = FAILURE;\n            t._index--;\n        }\n    };\n}\nfunction consumeSpecialNameChar(upper, NEXT_STATE) {\n    var lower = upper.toLowerCase();\n    return function (t, c) {\n        if (c === lower || c === upper) {\n            t._state = NEXT_STATE;\n        }\n        else {\n            t._state = 3 /* InTagName */;\n            t._index--; // Consume the token again\n        }\n    };\n}\nvar stateBeforeCdata1 = ifElseState(\"C\", 24 /* BeforeCdata2 */, 16 /* InDeclaration */);\nvar stateBeforeCdata2 = ifElseState(\"D\", 25 /* BeforeCdata3 */, 16 /* InDeclaration */);\nvar stateBeforeCdata3 = ifElseState(\"A\", 26 /* BeforeCdata4 */, 16 /* InDeclaration */);\nvar stateBeforeCdata4 = ifElseState(\"T\", 27 /* BeforeCdata5 */, 16 /* InDeclaration */);\nvar stateBeforeCdata5 = ifElseState(\"A\", 28 /* BeforeCdata6 */, 16 /* InDeclaration */);\nvar stateBeforeScript1 = consumeSpecialNameChar(\"R\", 35 /* BeforeScript2 */);\nvar stateBeforeScript2 = consumeSpecialNameChar(\"I\", 36 /* BeforeScript3 */);\nvar stateBeforeScript3 = consumeSpecialNameChar(\"P\", 37 /* BeforeScript4 */);\nvar stateBeforeScript4 = consumeSpecialNameChar(\"T\", 38 /* BeforeScript5 */);\nvar stateAfterScript1 = ifElseState(\"R\", 40 /* AfterScript2 */, 1 /* Text */);\nvar stateAfterScript2 = ifElseState(\"I\", 41 /* AfterScript3 */, 1 /* Text */);\nvar stateAfterScript3 = ifElseState(\"P\", 42 /* AfterScript4 */, 1 /* Text */);\nvar stateAfterScript4 = ifElseState(\"T\", 43 /* AfterScript5 */, 1 /* Text */);\nvar stateBeforeStyle1 = consumeSpecialNameChar(\"Y\", 45 /* BeforeStyle2 */);\nvar stateBeforeStyle2 = consumeSpecialNameChar(\"L\", 46 /* BeforeStyle3 */);\nvar stateBeforeStyle3 = consumeSpecialNameChar(\"E\", 47 /* BeforeStyle4 */);\nvar stateAfterStyle1 = ifElseState(\"Y\", 49 /* AfterStyle2 */, 1 /* Text */);\nvar stateAfterStyle2 = ifElseState(\"L\", 50 /* AfterStyle3 */, 1 /* Text */);\nvar stateAfterStyle3 = ifElseState(\"E\", 51 /* AfterStyle4 */, 1 /* Text */);\nvar stateBeforeSpecialT = consumeSpecialNameChar(\"I\", 54 /* BeforeTitle1 */);\nvar stateBeforeTitle1 = consumeSpecialNameChar(\"T\", 55 /* BeforeTitle2 */);\nvar stateBeforeTitle2 = consumeSpecialNameChar(\"L\", 56 /* BeforeTitle3 */);\nvar stateBeforeTitle3 = consumeSpecialNameChar(\"E\", 57 /* BeforeTitle4 */);\nvar stateAfterSpecialTEnd = ifElseState(\"I\", 58 /* AfterTitle1 */, 1 /* Text */);\nvar stateAfterTitle1 = ifElseState(\"T\", 59 /* AfterTitle2 */, 1 /* Text */);\nvar stateAfterTitle2 = ifElseState(\"L\", 60 /* AfterTitle3 */, 1 /* Text */);\nvar stateAfterTitle3 = ifElseState(\"E\", 61 /* AfterTitle4 */, 1 /* Text */);\nvar stateBeforeEntity = ifElseState(\"#\", 63 /* BeforeNumericEntity */, 64 /* InNamedEntity */);\nvar stateBeforeNumericEntity = ifElseState(\"X\", 66 /* InHexEntity */, 65 /* InNumericEntity */);\nvar Tokenizer = /** @class */ (function () {\n    function Tokenizer(options, cbs) {\n        var _a;\n        /** The current state the tokenizer is in. */\n        this._state = 1 /* Text */;\n        /** The read buffer. */\n        this.buffer = \"\";\n        /** The beginning of the section that is currently being read. */\n        this.sectionStart = 0;\n        /** The index within the buffer that we are currently looking at. */\n        this._index = 0;\n        /**\n         * Data that has already been processed will be removed from the buffer occasionally.\n         * `_bufferOffset` keeps track of how many characters have been removed, to make sure position information is accurate.\n         */\n        this.bufferOffset = 0;\n        /** Some behavior, eg. when decoding entities, is done while we are in another state. This keeps track of the other state type. */\n        this.baseState = 1 /* Text */;\n        /** For special parsing behavior inside of script and style tags. */\n        this.special = 1 /* None */;\n        /** Indicates whether the tokenizer has been paused. */\n        this.running = true;\n        /** Indicates whether the tokenizer has finished running / `.end` has been called. */\n        this.ended = false;\n        this.cbs = cbs;\n        this.xmlMode = !!(options === null || options === void 0 ? void 0 : options.xmlMode);\n        this.decodeEntities = (_a = options === null || options === void 0 ? void 0 : options.decodeEntities) !== null && _a !== void 0 ? _a : true;\n    }\n    Tokenizer.prototype.reset = function () {\n        this._state = 1 /* Text */;\n        this.buffer = \"\";\n        this.sectionStart = 0;\n        this._index = 0;\n        this.bufferOffset = 0;\n        this.baseState = 1 /* Text */;\n        this.special = 1 /* None */;\n        this.running = true;\n        this.ended = false;\n    };\n    Tokenizer.prototype.write = function (chunk) {\n        if (this.ended)\n            this.cbs.onerror(Error(\".write() after done!\"));\n        this.buffer += chunk;\n        this.parse();\n    };\n    Tokenizer.prototype.end = function (chunk) {\n        if (this.ended)\n            this.cbs.onerror(Error(\".end() after done!\"));\n        if (chunk)\n            this.write(chunk);\n        this.ended = true;\n        if (this.running)\n            this.finish();\n    };\n    Tokenizer.prototype.pause = function () {\n        this.running = false;\n    };\n    Tokenizer.prototype.resume = function () {\n        this.running = true;\n        if (this._index < this.buffer.length) {\n            this.parse();\n        }\n        if (this.ended) {\n            this.finish();\n        }\n    };\n    /**\n     * The current index within all of the written data.\n     */\n    Tokenizer.prototype.getAbsoluteIndex = function () {\n        return this.bufferOffset + this._index;\n    };\n    Tokenizer.prototype.stateText = function (c) {\n        if (c === \"<\") {\n            if (this._index > this.sectionStart) {\n                this.cbs.ontext(this.getSection());\n            }\n            this._state = 2 /* BeforeTagName */;\n            this.sectionStart = this._index;\n        }\n        else if (this.decodeEntities &&\n            c === \"&\" &&\n            (this.special === 1 /* None */ || this.special === 4 /* Title */)) {\n            if (this._index > this.sectionStart) {\n                this.cbs.ontext(this.getSection());\n            }\n            this.baseState = 1 /* Text */;\n            this._state = 62 /* BeforeEntity */;\n            this.sectionStart = this._index;\n        }\n    };\n    /**\n     * HTML only allows ASCII alpha characters (a-z and A-Z) at the beginning of a tag name.\n     *\n     * XML allows a lot more characters here (@see https://www.w3.org/TR/REC-xml/#NT-NameStartChar).\n     * We allow anything that wouldn't end the tag.\n     */\n    Tokenizer.prototype.isTagStartChar = function (c) {\n        return (isASCIIAlpha(c) ||\n            (this.xmlMode && !whitespace(c) && c !== \"/\" && c !== \">\"));\n    };\n    Tokenizer.prototype.stateBeforeTagName = function (c) {\n        if (c === \"/\") {\n            this._state = 5 /* BeforeClosingTagName */;\n        }\n        else if (c === \"<\") {\n            this.cbs.ontext(this.getSection());\n            this.sectionStart = this._index;\n        }\n        else if (c === \">\" ||\n            this.special !== 1 /* None */ ||\n            whitespace(c)) {\n            this._state = 1 /* Text */;\n        }\n        else if (c === \"!\") {\n            this._state = 15 /* BeforeDeclaration */;\n            this.sectionStart = this._index + 1;\n        }\n        else if (c === \"?\") {\n            this._state = 17 /* InProcessingInstruction */;\n            this.sectionStart = this._index + 1;\n        }\n        else if (!this.isTagStartChar(c)) {\n            this._state = 1 /* Text */;\n        }\n        else {\n            this._state =\n                !this.xmlMode && (c === \"s\" || c === \"S\")\n                    ? 32 /* BeforeSpecialS */\n                    : !this.xmlMode && (c === \"t\" || c === \"T\")\n                        ? 52 /* BeforeSpecialT */\n                        : 3 /* InTagName */;\n            this.sectionStart = this._index;\n        }\n    };\n    Tokenizer.prototype.stateInTagName = function (c) {\n        if (c === \"/\" || c === \">\" || whitespace(c)) {\n            this.emitToken(\"onopentagname\");\n            this._state = 8 /* BeforeAttributeName */;\n            this._index--;\n        }\n    };\n    Tokenizer.prototype.stateBeforeClosingTagName = function (c) {\n        if (whitespace(c)) {\n            // Ignore\n        }\n        else if (c === \">\") {\n            this._state = 1 /* Text */;\n        }\n        else if (this.special !== 1 /* None */) {\n            if (this.special !== 4 /* Title */ && (c === \"s\" || c === \"S\")) {\n                this._state = 33 /* BeforeSpecialSEnd */;\n            }\n            else if (this.special === 4 /* Title */ &&\n                (c === \"t\" || c === \"T\")) {\n                this._state = 53 /* BeforeSpecialTEnd */;\n            }\n            else {\n                this._state = 1 /* Text */;\n                this._index--;\n            }\n        }\n        else if (!this.isTagStartChar(c)) {\n            this._state = 20 /* InSpecialComment */;\n            this.sectionStart = this._index;\n        }\n        else {\n            this._state = 6 /* InClosingTagName */;\n            this.sectionStart = this._index;\n        }\n    };\n    Tokenizer.prototype.stateInClosingTagName = function (c) {\n        if (c === \">\" || whitespace(c)) {\n            this.emitToken(\"onclosetag\");\n            this._state = 7 /* AfterClosingTagName */;\n            this._index--;\n        }\n    };\n    Tokenizer.prototype.stateAfterClosingTagName = function (c) {\n        // Skip everything until \">\"\n        if (c === \">\") {\n            this._state = 1 /* Text */;\n            this.sectionStart = this._index + 1;\n        }\n    };\n    Tokenizer.prototype.stateBeforeAttributeName = function (c) {\n        if (c === \">\") {\n            this.cbs.onopentagend();\n            this._state = 1 /* Text */;\n            this.sectionStart = this._index + 1;\n        }\n        else if (c === \"/\") {\n            this._state = 4 /* InSelfClosingTag */;\n        }\n        else if (!whitespace(c)) {\n            this._state = 9 /* InAttributeName */;\n            this.sectionStart = this._index;\n        }\n    };\n    Tokenizer.prototype.stateInSelfClosingTag = function (c) {\n        if (c === \">\") {\n            this.cbs.onselfclosingtag();\n            this._state = 1 /* Text */;\n            this.sectionStart = this._index + 1;\n            this.special = 1 /* None */; // Reset special state, in case of self-closing special tags\n        }\n        else if (!whitespace(c)) {\n            this._state = 8 /* BeforeAttributeName */;\n            this._index--;\n        }\n    };\n    Tokenizer.prototype.stateInAttributeName = function (c) {\n        if (c === \"=\" || c === \"/\" || c === \">\" || whitespace(c)) {\n            this.cbs.onattribname(this.getSection());\n            this.sectionStart = -1;\n            this._state = 10 /* AfterAttributeName */;\n            this._index--;\n        }\n    };\n    Tokenizer.prototype.stateAfterAttributeName = function (c) {\n        if (c === \"=\") {\n            this._state = 11 /* BeforeAttributeValue */;\n        }\n        else if (c === \"/\" || c === \">\") {\n            this.cbs.onattribend(undefined);\n            this._state = 8 /* BeforeAttributeName */;\n            this._index--;\n        }\n        else if (!whitespace(c)) {\n            this.cbs.onattribend(undefined);\n            this._state = 9 /* InAttributeName */;\n            this.sectionStart = this._index;\n        }\n    };\n    Tokenizer.prototype.stateBeforeAttributeValue = function (c) {\n        if (c === '\"') {\n            this._state = 12 /* InAttributeValueDq */;\n            this.sectionStart = this._index + 1;\n        }\n        else if (c === \"'\") {\n            this._state = 13 /* InAttributeValueSq */;\n            this.sectionStart = this._index + 1;\n        }\n        else if (!whitespace(c)) {\n            this._state = 14 /* InAttributeValueNq */;\n            this.sectionStart = this._index;\n            this._index--; // Reconsume token\n        }\n    };\n    Tokenizer.prototype.handleInAttributeValue = function (c, quote) {\n        if (c === quote) {\n            this.emitToken(\"onattribdata\");\n            this.cbs.onattribend(quote);\n            this._state = 8 /* BeforeAttributeName */;\n        }\n        else if (this.decodeEntities && c === \"&\") {\n            this.emitToken(\"onattribdata\");\n            this.baseState = this._state;\n            this._state = 62 /* BeforeEntity */;\n            this.sectionStart = this._index;\n        }\n    };\n    Tokenizer.prototype.stateInAttributeValueDoubleQuotes = function (c) {\n        this.handleInAttributeValue(c, '\"');\n    };\n    Tokenizer.prototype.stateInAttributeValueSingleQuotes = function (c) {\n        this.handleInAttributeValue(c, \"'\");\n    };\n    Tokenizer.prototype.stateInAttributeValueNoQuotes = function (c) {\n        if (whitespace(c) || c === \">\") {\n            this.emitToken(\"onattribdata\");\n            this.cbs.onattribend(null);\n            this._state = 8 /* BeforeAttributeName */;\n            this._index--;\n        }\n        else if (this.decodeEntities && c === \"&\") {\n            this.emitToken(\"onattribdata\");\n            this.baseState = this._state;\n            this._state = 62 /* BeforeEntity */;\n            this.sectionStart = this._index;\n        }\n    };\n    Tokenizer.prototype.stateBeforeDeclaration = function (c) {\n        this._state =\n            c === \"[\"\n                ? 23 /* BeforeCdata1 */\n                : c === \"-\"\n                    ? 18 /* BeforeComment */\n                    : 16 /* InDeclaration */;\n    };\n    Tokenizer.prototype.stateInDeclaration = function (c) {\n        if (c === \">\") {\n            this.cbs.ondeclaration(this.getSection());\n            this._state = 1 /* Text */;\n            this.sectionStart = this._index + 1;\n        }\n    };\n    Tokenizer.prototype.stateInProcessingInstruction = function (c) {\n        if (c === \">\") {\n            this.cbs.onprocessinginstruction(this.getSection());\n            this._state = 1 /* Text */;\n            this.sectionStart = this._index + 1;\n        }\n    };\n    Tokenizer.prototype.stateBeforeComment = function (c) {\n        if (c === \"-\") {\n            this._state = 19 /* InComment */;\n            this.sectionStart = this._index + 1;\n        }\n        else {\n            this._state = 16 /* InDeclaration */;\n        }\n    };\n    Tokenizer.prototype.stateInComment = function (c) {\n        if (c === \"-\")\n            this._state = 21 /* AfterComment1 */;\n    };\n    Tokenizer.prototype.stateInSpecialComment = function (c) {\n        if (c === \">\") {\n            this.cbs.oncomment(this.buffer.substring(this.sectionStart, this._index));\n            this._state = 1 /* Text */;\n            this.sectionStart = this._index + 1;\n        }\n    };\n    Tokenizer.prototype.stateAfterComment1 = function (c) {\n        if (c === \"-\") {\n            this._state = 22 /* AfterComment2 */;\n        }\n        else {\n            this._state = 19 /* InComment */;\n        }\n    };\n    Tokenizer.prototype.stateAfterComment2 = function (c) {\n        if (c === \">\") {\n            // Remove 2 trailing chars\n            this.cbs.oncomment(this.buffer.substring(this.sectionStart, this._index - 2));\n            this._state = 1 /* Text */;\n            this.sectionStart = this._index + 1;\n        }\n        else if (c !== \"-\") {\n            this._state = 19 /* InComment */;\n        }\n        // Else: stay in AFTER_COMMENT_2 (`--->`)\n    };\n    Tokenizer.prototype.stateBeforeCdata6 = function (c) {\n        if (c === \"[\") {\n            this._state = 29 /* InCdata */;\n            this.sectionStart = this._index + 1;\n        }\n        else {\n            this._state = 16 /* InDeclaration */;\n            this._index--;\n        }\n    };\n    Tokenizer.prototype.stateInCdata = function (c) {\n        if (c === \"]\")\n            this._state = 30 /* AfterCdata1 */;\n    };\n    Tokenizer.prototype.stateAfterCdata1 = function (c) {\n        if (c === \"]\")\n            this._state = 31 /* AfterCdata2 */;\n        else\n            this._state = 29 /* InCdata */;\n    };\n    Tokenizer.prototype.stateAfterCdata2 = function (c) {\n        if (c === \">\") {\n            // Remove 2 trailing chars\n            this.cbs.oncdata(this.buffer.substring(this.sectionStart, this._index - 2));\n            this._state = 1 /* Text */;\n            this.sectionStart = this._index + 1;\n        }\n        else if (c !== \"]\") {\n            this._state = 29 /* InCdata */;\n        }\n        // Else: stay in AFTER_CDATA_2 (`]]]>`)\n    };\n    Tokenizer.prototype.stateBeforeSpecialS = function (c) {\n        if (c === \"c\" || c === \"C\") {\n            this._state = 34 /* BeforeScript1 */;\n        }\n        else if (c === \"t\" || c === \"T\") {\n            this._state = 44 /* BeforeStyle1 */;\n        }\n        else {\n            this._state = 3 /* InTagName */;\n            this._index--; // Consume the token again\n        }\n    };\n    Tokenizer.prototype.stateBeforeSpecialSEnd = function (c) {\n        if (this.special === 2 /* Script */ && (c === \"c\" || c === \"C\")) {\n            this._state = 39 /* AfterScript1 */;\n        }\n        else if (this.special === 3 /* Style */ && (c === \"t\" || c === \"T\")) {\n            this._state = 48 /* AfterStyle1 */;\n        }\n        else\n            this._state = 1 /* Text */;\n    };\n    Tokenizer.prototype.stateBeforeSpecialLast = function (c, special) {\n        if (c === \"/\" || c === \">\" || whitespace(c)) {\n            this.special = special;\n        }\n        this._state = 3 /* InTagName */;\n        this._index--; // Consume the token again\n    };\n    Tokenizer.prototype.stateAfterSpecialLast = function (c, sectionStartOffset) {\n        if (c === \">\" || whitespace(c)) {\n            this.special = 1 /* None */;\n            this._state = 6 /* InClosingTagName */;\n            this.sectionStart = this._index - sectionStartOffset;\n            this._index--; // Reconsume the token\n        }\n        else\n            this._state = 1 /* Text */;\n    };\n    // For entities terminated with a semicolon\n    Tokenizer.prototype.parseFixedEntity = function (map) {\n        if (map === void 0) { map = this.xmlMode ? xml_json_1.default : entities_json_1.default; }\n        // Offset = 1\n        if (this.sectionStart + 1 < this._index) {\n            var entity = this.buffer.substring(this.sectionStart + 1, this._index);\n            if (Object.prototype.hasOwnProperty.call(map, entity)) {\n                this.emitPartial(map[entity]);\n                this.sectionStart = this._index + 1;\n            }\n        }\n    };\n    // Parses legacy entities (without trailing semicolon)\n    Tokenizer.prototype.parseLegacyEntity = function () {\n        var start = this.sectionStart + 1;\n        // The max length of legacy entities is 6\n        var limit = Math.min(this._index - start, 6);\n        while (limit >= 2) {\n            // The min length of legacy entities is 2\n            var entity = this.buffer.substr(start, limit);\n            if (Object.prototype.hasOwnProperty.call(legacy_json_1.default, entity)) {\n                this.emitPartial(legacy_json_1.default[entity]);\n                this.sectionStart += limit + 1;\n                return;\n            }\n            limit--;\n        }\n    };\n    Tokenizer.prototype.stateInNamedEntity = function (c) {\n        if (c === \";\") {\n            this.parseFixedEntity();\n            // Retry as legacy entity if entity wasn't parsed\n            if (this.baseState === 1 /* Text */ &&\n                this.sectionStart + 1 < this._index &&\n                !this.xmlMode) {\n                this.parseLegacyEntity();\n            }\n            this._state = this.baseState;\n        }\n        else if ((c < \"0\" || c > \"9\") && !isASCIIAlpha(c)) {\n            if (this.xmlMode || this.sectionStart + 1 === this._index) {\n                // Ignore\n            }\n            else if (this.baseState !== 1 /* Text */) {\n                if (c !== \"=\") {\n                    // Parse as legacy entity, without allowing additional characters.\n                    this.parseFixedEntity(legacy_json_1.default);\n                }\n            }\n            else {\n                this.parseLegacyEntity();\n            }\n            this._state = this.baseState;\n            this._index--;\n        }\n    };\n    Tokenizer.prototype.decodeNumericEntity = function (offset, base, strict) {\n        var sectionStart = this.sectionStart + offset;\n        if (sectionStart !== this._index) {\n            // Parse entity\n            var entity = this.buffer.substring(sectionStart, this._index);\n            var parsed = parseInt(entity, base);\n            this.emitPartial(decode_codepoint_1.default(parsed));\n            this.sectionStart = strict ? this._index + 1 : this._index;\n        }\n        this._state = this.baseState;\n    };\n    Tokenizer.prototype.stateInNumericEntity = function (c) {\n        if (c === \";\") {\n            this.decodeNumericEntity(2, 10, true);\n        }\n        else if (c < \"0\" || c > \"9\") {\n            if (!this.xmlMode) {\n                this.decodeNumericEntity(2, 10, false);\n            }\n            else {\n                this._state = this.baseState;\n            }\n            this._index--;\n        }\n    };\n    Tokenizer.prototype.stateInHexEntity = function (c) {\n        if (c === \";\") {\n            this.decodeNumericEntity(3, 16, true);\n        }\n        else if ((c < \"a\" || c > \"f\") &&\n            (c < \"A\" || c > \"F\") &&\n            (c < \"0\" || c > \"9\")) {\n            if (!this.xmlMode) {\n                this.decodeNumericEntity(3, 16, false);\n            }\n            else {\n                this._state = this.baseState;\n            }\n            this._index--;\n        }\n    };\n    Tokenizer.prototype.cleanup = function () {\n        if (this.sectionStart < 0) {\n            this.buffer = \"\";\n            this.bufferOffset += this._index;\n            this._index = 0;\n        }\n        else if (this.running) {\n            if (this._state === 1 /* Text */) {\n                if (this.sectionStart !== this._index) {\n                    this.cbs.ontext(this.buffer.substr(this.sectionStart));\n                }\n                this.buffer = \"\";\n                this.bufferOffset += this._index;\n                this._index = 0;\n            }\n            else if (this.sectionStart === this._index) {\n                // The section just started\n                this.buffer = \"\";\n                this.bufferOffset += this._index;\n                this._index = 0;\n            }\n            else {\n                // Remove everything unnecessary\n                this.buffer = this.buffer.substr(this.sectionStart);\n                this._index -= this.sectionStart;\n                this.bufferOffset += this.sectionStart;\n            }\n            this.sectionStart = 0;\n        }\n    };\n    /**\n     * Iterates through the buffer, calling the function corresponding to the current state.\n     *\n     * States that are more likely to be hit are higher up, as a performance improvement.\n     */\n    Tokenizer.prototype.parse = function () {\n        while (this._index < this.buffer.length && this.running) {\n            var c = this.buffer.charAt(this._index);\n            if (this._state === 1 /* Text */) {\n                this.stateText(c);\n            }\n            else if (this._state === 12 /* InAttributeValueDq */) {\n                this.stateInAttributeValueDoubleQuotes(c);\n            }\n            else if (this._state === 9 /* InAttributeName */) {\n                this.stateInAttributeName(c);\n            }\n            else if (this._state === 19 /* InComment */) {\n                this.stateInComment(c);\n            }\n            else if (this._state === 20 /* InSpecialComment */) {\n                this.stateInSpecialComment(c);\n            }\n            else if (this._state === 8 /* BeforeAttributeName */) {\n                this.stateBeforeAttributeName(c);\n            }\n            else if (this._state === 3 /* InTagName */) {\n                this.stateInTagName(c);\n            }\n            else if (this._state === 6 /* InClosingTagName */) {\n                this.stateInClosingTagName(c);\n            }\n            else if (this._state === 2 /* BeforeTagName */) {\n                this.stateBeforeTagName(c);\n            }\n            else if (this._state === 10 /* AfterAttributeName */) {\n                this.stateAfterAttributeName(c);\n            }\n            else if (this._state === 13 /* InAttributeValueSq */) {\n                this.stateInAttributeValueSingleQuotes(c);\n            }\n            else if (this._state === 11 /* BeforeAttributeValue */) {\n                this.stateBeforeAttributeValue(c);\n            }\n            else if (this._state === 5 /* BeforeClosingTagName */) {\n                this.stateBeforeClosingTagName(c);\n            }\n            else if (this._state === 7 /* AfterClosingTagName */) {\n                this.stateAfterClosingTagName(c);\n            }\n            else if (this._state === 32 /* BeforeSpecialS */) {\n                this.stateBeforeSpecialS(c);\n            }\n            else if (this._state === 21 /* AfterComment1 */) {\n                this.stateAfterComment1(c);\n            }\n            else if (this._state === 14 /* InAttributeValueNq */) {\n                this.stateInAttributeValueNoQuotes(c);\n            }\n            else if (this._state === 4 /* InSelfClosingTag */) {\n                this.stateInSelfClosingTag(c);\n            }\n            else if (this._state === 16 /* InDeclaration */) {\n                this.stateInDeclaration(c);\n            }\n            else if (this._state === 15 /* BeforeDeclaration */) {\n                this.stateBeforeDeclaration(c);\n            }\n            else if (this._state === 22 /* AfterComment2 */) {\n                this.stateAfterComment2(c);\n            }\n            else if (this._state === 18 /* BeforeComment */) {\n                this.stateBeforeComment(c);\n            }\n            else if (this._state === 33 /* BeforeSpecialSEnd */) {\n                this.stateBeforeSpecialSEnd(c);\n            }\n            else if (this._state === 53 /* BeforeSpecialTEnd */) {\n                stateAfterSpecialTEnd(this, c);\n            }\n            else if (this._state === 39 /* AfterScript1 */) {\n                stateAfterScript1(this, c);\n            }\n            else if (this._state === 40 /* AfterScript2 */) {\n                stateAfterScript2(this, c);\n            }\n            else if (this._state === 41 /* AfterScript3 */) {\n                stateAfterScript3(this, c);\n            }\n            else if (this._state === 34 /* BeforeScript1 */) {\n                stateBeforeScript1(this, c);\n            }\n            else if (this._state === 35 /* BeforeScript2 */) {\n                stateBeforeScript2(this, c);\n            }\n            else if (this._state === 36 /* BeforeScript3 */) {\n                stateBeforeScript3(this, c);\n            }\n            else if (this._state === 37 /* BeforeScript4 */) {\n                stateBeforeScript4(this, c);\n            }\n            else if (this._state === 38 /* BeforeScript5 */) {\n                this.stateBeforeSpecialLast(c, 2 /* Script */);\n            }\n            else if (this._state === 42 /* AfterScript4 */) {\n                stateAfterScript4(this, c);\n            }\n            else if (this._state === 43 /* AfterScript5 */) {\n                this.stateAfterSpecialLast(c, 6);\n            }\n            else if (this._state === 44 /* BeforeStyle1 */) {\n                stateBeforeStyle1(this, c);\n            }\n            else if (this._state === 29 /* InCdata */) {\n                this.stateInCdata(c);\n            }\n            else if (this._state === 45 /* BeforeStyle2 */) {\n                stateBeforeStyle2(this, c);\n            }\n            else if (this._state === 46 /* BeforeStyle3 */) {\n                stateBeforeStyle3(this, c);\n            }\n            else if (this._state === 47 /* BeforeStyle4 */) {\n                this.stateBeforeSpecialLast(c, 3 /* Style */);\n            }\n            else if (this._state === 48 /* AfterStyle1 */) {\n                stateAfterStyle1(this, c);\n            }\n            else if (this._state === 49 /* AfterStyle2 */) {\n                stateAfterStyle2(this, c);\n            }\n            else if (this._state === 50 /* AfterStyle3 */) {\n                stateAfterStyle3(this, c);\n            }\n            else if (this._state === 51 /* AfterStyle4 */) {\n                this.stateAfterSpecialLast(c, 5);\n            }\n            else if (this._state === 52 /* BeforeSpecialT */) {\n                stateBeforeSpecialT(this, c);\n            }\n            else if (this._state === 54 /* BeforeTitle1 */) {\n                stateBeforeTitle1(this, c);\n            }\n            else if (this._state === 55 /* BeforeTitle2 */) {\n                stateBeforeTitle2(this, c);\n            }\n            else if (this._state === 56 /* BeforeTitle3 */) {\n                stateBeforeTitle3(this, c);\n            }\n            else if (this._state === 57 /* BeforeTitle4 */) {\n                this.stateBeforeSpecialLast(c, 4 /* Title */);\n            }\n            else if (this._state === 58 /* AfterTitle1 */) {\n                stateAfterTitle1(this, c);\n            }\n            else if (this._state === 59 /* AfterTitle2 */) {\n                stateAfterTitle2(this, c);\n            }\n            else if (this._state === 60 /* AfterTitle3 */) {\n                stateAfterTitle3(this, c);\n            }\n            else if (this._state === 61 /* AfterTitle4 */) {\n                this.stateAfterSpecialLast(c, 5);\n            }\n            else if (this._state === 17 /* InProcessingInstruction */) {\n                this.stateInProcessingInstruction(c);\n            }\n            else if (this._state === 64 /* InNamedEntity */) {\n                this.stateInNamedEntity(c);\n            }\n            else if (this._state === 23 /* BeforeCdata1 */) {\n                stateBeforeCdata1(this, c);\n            }\n            else if (this._state === 62 /* BeforeEntity */) {\n                stateBeforeEntity(this, c);\n            }\n            else if (this._state === 24 /* BeforeCdata2 */) {\n                stateBeforeCdata2(this, c);\n            }\n            else if (this._state === 25 /* BeforeCdata3 */) {\n                stateBeforeCdata3(this, c);\n            }\n            else if (this._state === 30 /* AfterCdata1 */) {\n                this.stateAfterCdata1(c);\n            }\n            else if (this._state === 31 /* AfterCdata2 */) {\n                this.stateAfterCdata2(c);\n            }\n            else if (this._state === 26 /* BeforeCdata4 */) {\n                stateBeforeCdata4(this, c);\n            }\n            else if (this._state === 27 /* BeforeCdata5 */) {\n                stateBeforeCdata5(this, c);\n            }\n            else if (this._state === 28 /* BeforeCdata6 */) {\n                this.stateBeforeCdata6(c);\n            }\n            else if (this._state === 66 /* InHexEntity */) {\n                this.stateInHexEntity(c);\n            }\n            else if (this._state === 65 /* InNumericEntity */) {\n                this.stateInNumericEntity(c);\n                // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n            }\n            else if (this._state === 63 /* BeforeNumericEntity */) {\n                stateBeforeNumericEntity(this, c);\n            }\n            else {\n                this.cbs.onerror(Error(\"unknown _state\"), this._state);\n            }\n            this._index++;\n        }\n        this.cleanup();\n    };\n    Tokenizer.prototype.finish = function () {\n        // If there is remaining data, emit it in a reasonable way\n        if (this.sectionStart < this._index) {\n            this.handleTrailingData();\n        }\n        this.cbs.onend();\n    };\n    Tokenizer.prototype.handleTrailingData = function () {\n        var data = this.buffer.substr(this.sectionStart);\n        if (this._state === 29 /* InCdata */ ||\n            this._state === 30 /* AfterCdata1 */ ||\n            this._state === 31 /* AfterCdata2 */) {\n            this.cbs.oncdata(data);\n        }\n        else if (this._state === 19 /* InComment */ ||\n            this._state === 21 /* AfterComment1 */ ||\n            this._state === 22 /* AfterComment2 */) {\n            this.cbs.oncomment(data);\n        }\n        else if (this._state === 64 /* InNamedEntity */ && !this.xmlMode) {\n            this.parseLegacyEntity();\n            if (this.sectionStart < this._index) {\n                this._state = this.baseState;\n                this.handleTrailingData();\n            }\n        }\n        else if (this._state === 65 /* InNumericEntity */ && !this.xmlMode) {\n            this.decodeNumericEntity(2, 10, false);\n            if (this.sectionStart < this._index) {\n                this._state = this.baseState;\n                this.handleTrailingData();\n            }\n        }\n        else if (this._state === 66 /* InHexEntity */ && !this.xmlMode) {\n            this.decodeNumericEntity(3, 16, false);\n            if (this.sectionStart < this._index) {\n                this._state = this.baseState;\n                this.handleTrailingData();\n            }\n        }\n        else if (this._state !== 3 /* InTagName */ &&\n            this._state !== 8 /* BeforeAttributeName */ &&\n            this._state !== 11 /* BeforeAttributeValue */ &&\n            this._state !== 10 /* AfterAttributeName */ &&\n            this._state !== 9 /* InAttributeName */ &&\n            this._state !== 13 /* InAttributeValueSq */ &&\n            this._state !== 12 /* InAttributeValueDq */ &&\n            this._state !== 14 /* InAttributeValueNq */ &&\n            this._state !== 6 /* InClosingTagName */) {\n            this.cbs.ontext(data);\n        }\n        /*\n         * Else, ignore remaining data\n         * TODO add a way to remove current tag\n         */\n    };\n    Tokenizer.prototype.getSection = function () {\n        return this.buffer.substring(this.sectionStart, this._index);\n    };\n    Tokenizer.prototype.emitToken = function (name) {\n        this.cbs[name](this.getSection());\n        this.sectionStart = -1;\n    };\n    Tokenizer.prototype.emitPartial = function (value) {\n        if (this.baseState !== 1 /* Text */) {\n            this.cbs.onattribdata(value); // TODO implement the new event\n        }\n        else {\n            this.cbs.ontext(value);\n        }\n    };\n    return Tokenizer;\n}());\nexports.default = Tokenizer;\n"]},"metadata":{},"sourceType":"script"}